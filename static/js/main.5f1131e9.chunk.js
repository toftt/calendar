(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{112:function(e,t,n){e.exports=n(261)},117:function(e,t,n){},119:function(e,t,n){},123:function(e,t){var n=document.getElementById("canv"),a=n.getContext("2d"),r=n.width=document.documentElement.clientWidth,c=n.height=document.documentElement.clientHeight;!function(){for(var e,t=[],n=1,o=20,i=0;i<400;++i)(e=new s).y=Math.random()*(c+50),e.x=Math.random()*r,e.t=Math.random()*(2*Math.PI),e.sz=100/(10+100*Math.random())*.5*1.3,e.sp=.15*Math.pow(.8*e.sz,2)*.5*1,e.sp=e.sp<1?1:e.sp,t.push(e);function s(){this.draw=function(){this.g=a.createRadialGradient(this.x,this.y,0,this.x,this.y,this.sz),this.g.addColorStop(0,"hsla(255,255%,255%,1)"),this.g.addColorStop(1,"hsla(255,255%,255%,0)"),a.moveTo(this.x,this.y),a.fillStyle=this.g,a.beginPath(),a.arc(this.x,this.y,this.sz,0,2*Math.PI,!0),a.fill()}}!function e(){window.requestAnimationFrame(e);a.clearRect(0,0,r,c);a.fillStyle="hsla(242, 95%, 3%, 0)";a.fillRect(0,0,r,c);a.fill();for(var i=0;i<t.length;++i){var s=t[i];s.t+=.05,s.t=s.t>=2*Math.PI?0:s.t,s.y+=.7*s.sp,s.x+=.7*Math.sin(s.t*n)*(.3*s.sz),s.y>c+50&&(s.y=-10-Math.random()*o),s.x>r+o&&(s.x=-o),s.x<-o&&(s.x=r+o),s.draw()}}()}(),window.addEventListener("resize",function(){n.width=r=document.documentElement.clientWidth,n.height=c=document.documentElement.clientHeight},!1)},261:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(22),o=n.n(c),i=(n(117),n(119),n(123),n(6)),s=n(7),l=n(9),u=n(8),p=n(10),d=n(20),h=n(45),m=n(21),f={token:null,tracks:Array.apply(null,Array(24)),searchResults:[],currentlyPlaying:null,categories:[]},b=function(e){return{type:"SET_SEARCH_RESULTS",tracks:e}},g=n(19),k=n(111),y=n.n(k),E=n(65),O=n.n(E),v=n(107),w=n.n(v),j=n(50),C=n.n(j),S=n(108),x=n.n(S),R=n(47),T=n.n(R),A=n(99),I=n.n(A),D=n(100),N=n.n(D),_=n(106),P=n.n(_),M=n(37),L=n.n(M),z=n(36),K=n.n(z),F=n(101),G=n.n(F),U=n(103),W=n.n(U),B=n(102),H=n.n(B),Y=n(104),J=n.n(Y),V=n(105),q=n.n(V),Q=n(97),X=n.n(Q),Z=n(98),$=n.n(Z),ee=["toplists","pop","hiphop","rock","workout","chill","edm_dance","mood"],te=new X.a;te.setPromiseImplementation($.a);var ne=function(e,t){return te.setAccessToken(e),te.searchTracks(t,{limit:10})},ae=function(e,t){return te.setAccessToken(e),te.play(t)},re=function(e){return te.setAccessToken(e),te.pause()},ce=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).handleClick=function(e){e.stopPropagation();var t=n.props,a=t.currentlyPlaying,r=t.play,c=t.pause,o=t.track.id;o===a?re(n.props.token).then(function(){return c()}):ae(n.props.token,{uris:[n.props.track.uri]}).then(function(){return r(o)})},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.classes,a=(t.theme,t.track),c=t.date,o=t.removeTrack,i=t.handleClose,s=t.currentlyPlaying,l=a.name,u=a.artists,p=a.id===s;return r.a.createElement(I.a,{className:n.card},r.a.createElement("div",{className:n.details},r.a.createElement(N.a,{className:n.content},r.a.createElement(K.a,{component:"h5",variant:"h5"},l.length<=23?l:l.substr(0,23)+"..."),r.a.createElement(K.a,{variant:"subtitle1",color:"textSecondary"},u[0].name)),r.a.createElement("div",{className:n.controls},r.a.createElement(L.a,{disabled:!0,"aria-label":"Previous"},r.a.createElement(G.a,null)),r.a.createElement(L.a,{"aria-label":"Play/pause",onClick:function(t){return e.handleClick(t)}},p?r.a.createElement(H.a,{className:n.playIcon}):r.a.createElement(W.a,{className:n.playIcon})),r.a.createElement(L.a,{disabled:!0,"aria-label":"Next"},r.a.createElement(J.a,null)),this.props.canRemove?r.a.createElement(L.a,{"aria-label":"Clear",onClick:function(){i(),o(c)}},r.a.createElement(q.a,null)):null)),r.a.createElement(P.a,{className:n.cover,image:a.album.images[0].url,title:"".concat(a.album.name," Album Cover")}))}}]),t}(r.a.Component),oe=Object(d.b)(function(e){return{token:e.token,currentlyPlaying:e.currentlyPlaying}},{removeTrack:function(e){return{type:"REMOVE_TRACK",index:e}},play:function(e){return{type:"PLAY",trackId:e}},pause:function(){return{type:"PAUSE"}}})(Object(g.withStyles)(function(e){return{card:{display:"flex",flexGrow:2,whiteSpace:"nowrap",textOverflow:"ellipsis"},details:{display:"flex",flexDirection:"column",flexGrow:2},content:{flex:"2 0 auto"},cover:{width:151,flexShrink:0},controls:{display:"flex",alignItems:"center",paddingLeft:e.spacing.unit,paddingBottom:e.spacing.unit},playIcon:{height:38,width:38}}},{withTheme:!0})(ce)),ie=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).onChange=function(e){e.preventDefault(),n.setState({input:e.target.value})},n.onSubmit=function(e){e.preventDefault(),n.state.input||n.setState({input:"Queen - Bohemian Rhapsody"}),ne(n.props.token,n.state.input).then(function(e){n.props.setSearchResults(e.tracks.items)})},n.state={input:"",results:[]},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.props.classes;return r.a.createElement("div",{id:"search_box"},r.a.createElement(w.a,{className:t.list},r.a.createElement(C.a,null,r.a.createElement("form",{onSubmit:function(t){return e.onSubmit(t)},autoComplete:"off",className:t.container},r.a.createElement(x.a,{fullWidth:!0},r.a.createElement(O.a,{rootRef:this.props.inputRef},r.a.createElement(T.a,{autoFocus:!0,className:t.input,value:this.state.input,onChange:function(t){return e.onChange(t)},placeholder:"Search for a track"}))))),r.a.createElement(C.a,null),this.props.searchResults.map(function(t){return r.a.createElement(C.a,{key:t.id,onClick:function(){return e.props.setTrack(t,e.props.selectedDate)}},r.a.createElement(oe,{track:t}))})))}}]),t}(r.a.Component),se=Object(d.b)(function(e){return{token:e.token,searchResults:e.searchResults}},{setTrack:function(e,t){return{type:"SET_TRACK",index:t,track:e}},setSearchResults:b})(Object(g.withStyles)(function(e){return{card:{display:"flex",width:"100%"},content:{flex:"1 0 auto"},search:{width:"100%"},container:{display:"flex",width:"inherit"},list:{width:"100%"},input:{fontSize:"1.3rem"},trackIndex:{textAlign:"center"}}})(ie)),le=n(109),ue=n.n(le),pe=n(66),de=n.n(pe),he=n(110),me=n.n(he),fe=function(e,t){return function(e,t){return te.setAccessToken(e),te.getCategoryPlaylists(t)}(e,t).then(function(t){return function(e,t){return te.setAccessToken(e),te.getPlaylistTracks(t)}(e,t.playlists.items[0].id)}).then(function(e){return e.items.map(function(e){return e.track}).slice(0,10)})},be=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){var e=this;(function(e){te.setAccessToken(e);var t=[];return te.getCategories().then(function(e){return e.categories.items.forEach(function(e){ee.includes(e.id)&&t.push(e)}),t})})(this.props.token).then(function(t){return e.props.setCategories(t)})}},{key:"render",value:function(){var e=this,t=this.props.classes;return r.a.createElement("div",{className:t.root},r.a.createElement(ue.a,{cellHeight:180,className:t.gridList,style:{height:"auto"}},r.a.createElement(de.a,{key:"Subheader",cols:2,style:{height:"auto"}}),this.props.categories.map(function(t){return r.a.createElement(de.a,{key:t.id,onClick:function(){return fe(e.props.token,t.id).then(function(t){return e.props.setSearchResults(t)})}},r.a.createElement("img",{src:t.icons[0].url,alt:t.name}),r.a.createElement(me.a,{title:t.name}))})))}}]),t}(r.a.Component),ge=Object(d.b)(function(e){return{token:e.token,categories:e.categories}},{setSearchResults:b,setCategories:function(e){return{type:"SET_CATEGORIES",categories:e}}})(Object(g.withStyles)(function(e){return{root:{display:"flex",flexWrap:"wrap",justifyContent:"space-around",overflow:"hidden",backgroundColor:"rgba(0,0,0,0)"},gridList:{width:500,height:450},icon:{color:"rgba(255, 255, 255, 0.54)"}}})(be)),ke=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.props.classes;return r.a.createElement(y.a,{open:this.props.open,onClose:function(){return e.props.toggleDrawer(!1)},classes:{paper:t.drawer}},r.a.createElement("div",{tabIndex:0,role:"button"},r.a.createElement(se,{inputRef:this.props.inputRef,selectedDate:this.props.selectedDate}),r.a.createElement(ge,null)))}}]),t}(r.a.Component),ye=Object(g.withStyles)({drawer:{backgroundColor:"rgba(255, 255, 255, 0.6)"}})(ke),Ee=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.props.classes;return r.a.createElement("div",{className:t.root},r.a.createElement(ye,{toggleDrawer:function(t){return e.props.toggleDrawer(t)},open:this.props.drawerIsOpen,selectedDate:this.props.selectedDate,inputRef:this.props.inputRef}))}}]),t}(r.a.Component),Oe=Object(g.withStyles)({drawer:{background:"rgba(255, 255, 255, 0.6)"},root:{flexGrow:1},grow:{flexGrow:1},menuButton:{marginLeft:-12,marginRight:20,color:"white"}})(Ee),ve=n(48),we=n.n(ve),je=n(35),Ce=n.n(je);var Se=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).handleOpen=function(){n.setState({open:!0})},n.handleClose=function(){n.setState({open:!1})},n.copyToClipboard=function(e){n.textArea.select(),document.execCommand("copy"),e.target.focus()},n.state={open:!1},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.props.classes;return r.a.createElement("div",null,r.a.createElement(we.a,{onClick:this.handleOpen,className:t.button,variant:"outlined"},"Share calendar"),r.a.createElement(Ce.a,{"aria-labelledby":"simple-modal-title","aria-describedby":"simple-modal-description",open:this.state.open,onClose:this.handleClose},r.a.createElement("div",{style:{top:"".concat(50,"%"),left:"".concat(50,"%"),transform:"translate(-".concat(50,"%, -").concat(50,"%)")},className:t.paper},r.a.createElement(K.a,{variant:"h6",id:"modal-title"},r.a.createElement(T.a,{value:function(e){if(24!==e.filter(function(e){return e}).length)return"You need to complete the calendar.";var t=window.location,n=t.origin,a=t.pathname,r=e.map(function(e){return e.id});return"".concat(n+a,"?tracks=").concat(r.join("_"))}(this.props.tracks),style:{width:"100%",overflow:"hidden",resize:"none",whiteSpace:"nowrap"},inputComponent:"textarea",inputRef:function(t){return e.textArea=t},onClick:this.copyToClipboard,readOnly:!0})))))}}]),t}(r.a.Component),xe=Object(d.b)(function(e){return{tracks:e.tracks}})(Object(g.withStyles)(function(e){return{paper:{position:"absolute",width:50*e.spacing.unit,backgroundColor:e.palette.background.paper,boxShadow:e.shadows[5],padding:4*e.spacing.unit},button:{fontSize:"20px",backgroundColor:"#007853",color:"white",margin:"5px",fontFamily:"Molengo","&:hover":{backgroundColor:"#007853"}}}})(Se));var Re=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.classes,n=e.open,a=e.date,c=e.handleClose;return r.a.createElement("div",null,r.a.createElement(Ce.a,{"aria-labelledby":"simple-modal-title","aria-describedby":"simple-modal-description",open:n,onClose:function(){return c()}},r.a.createElement("div",{style:{top:"".concat(50,"%"),left:"".concat(50,"%"),transform:"translate(-".concat(50,"%, -").concat(50,"%)")},className:t.paper},r.a.createElement(oe,{track:this.props.track,date:a,canRemove:"edit"===this.props.mode,handleClose:c}))))}}]),t}(r.a.Component),Te=Object(g.withStyles)(function(e){return{paper:{position:"absolute",width:"600px",backgroundColor:"rgba(255,255,255,.4)",boxShadow:e.shadows[5],padding:4*e.spacing.unit}}})(Re),Ae=new Date,Ie=Ae.getDate(),De=11===Ae.getMonth()?Ie:0,Ne=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).handleOpen=function(){n.setState({open:!0})},n.handleClose=function(){n.setState({open:!1})},n.state={open:!1},n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.date,a=t.track,c=t.toggleDrawer,o=t.mode,i=a&&n<=De||"edit"===o,s=a&&a.album.images[0].url,l=i&&s,u=function(){};return"edit"!==o||l?"edit"===o&&l?u=this.handleOpen:l&&(u=this.handleOpen):u=function(){return c(!0,n)},r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"day past",style:{backgroundImage:"url(".concat(l?s:"http://www.designcouch.com/assets/images/christmaspresent11.svg",")"),backgroundSize:l?"100% 100%":"45%"},onClick:u},r.a.createElement("span",{className:"date"},n)),r.a.createElement(Te,{open:this.state.open,date:n,mode:this.props.mode,track:a,handleClose:function(){return e.handleClose()}}))}}]),t}(r.a.Component),_e=[{id:"one",days:[1,2,3,4,5,6]},{id:"two",days:[7,8,9,10,11,12]},{id:"three",days:[13,14,15,16,17,18]},{id:"four",days:[19,20,21,22,23,24]}],Pe=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.props.classes,n=this.props.toggleDrawer;return r.a.createElement("div",{id:"calendar_wrapper"},r.a.createElement("h1",null,"Spotify Christmas Calendar"),r.a.createElement("section",{id:"calendar",className:"collectonme"},_e.map(function(t){return r.a.createElement("div",{id:t.id,key:t.id,className:"week"},t.days.map(function(t){if(null===t)return r.a.createElement("div",{className:"day noDate"});var a=e.props.tracks[t-1];return r.a.createElement(Ne,{date:t,key:t,track:a,toggleDrawer:n,mode:e.props.mode})}))})),"view"===this.props.mode?null:r.a.createElement("div",{className:t.container},r.a.createElement(we.a,{variant:"outlined",className:t.button,onClick:function(){return function(e,t){te.setAccessToken(e);var n=t.filter(function(e){return e}).map(function(e){return{x:e,r:Math.random()}}).sort(function(e,t){return e.r-t.r}).map(function(e){return e.x}).slice(0,5),a={seed_tracks:n.map(function(e){return e.id}),limit:24-n.length};return te.getRecommendations(a)}(e.props.token,e.props.tracks).then(function(t){return e.props.addRecommendations(t.tracks)})}},"Recommended autofill"),r.a.createElement(xe,null)),r.a.createElement("div",{id:"bottom",className:"collectonme"}))}}]),t}(r.a.Component),Me=Object(d.b)(function(e){var t=e.tracks;return{token:e.token,tracks:t}},{addRecommendations:function(e){return{type:"ADD_RECOMMENDATIONS",tracks:e}}})(Object(g.withStyles)({button:{fontSize:"20px",backgroundColor:"#007853",color:"white",margin:"5px",fontFamily:"Molengo","&:hover":{backgroundColor:"#007853"}},container:{display:"flex",justifyContent:"center",fontSize:"20px"}})(Pe)),Le=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).toggleDrawer=function(e,t){n.setState({drawerIsOpen:e,selectedDate:t},function(){!0===e&&n.textInput.current&&n.textInput.current.focus()})},n.state={drawerIsOpen:!1,selectedDate:1},n.textInput=r.a.createRef(),n}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{id:"bg-image"}),r.a.createElement(Oe,{toggleDrawer:function(t){return e.toggleDrawer(t)},drawerIsOpen:this.state.drawerIsOpen,inputRef:this.textInput,selectedDate:this.state.selectedDate}),r.a.createElement(Me,{toggleDrawer:function(t,n){return e.toggleDrawer(t,n)},mode:"edit"}))}}]),t}(r.a.Component),ze=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){var e,t,n=this;(e=this.props.token,t=this.props.trackIds,te.setAccessToken(e),te.getTracks(t)).then(function(e){return n.props.replaceAllTracks(e.tracks)})}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{id:"bg-image"}),r.a.createElement(Me,{toggleDrawer:function(e,t){},mode:"view"}))}}]),t}(r.a.Component),Ke=Object(d.b)(function(e){return{token:e.token}},{replaceAllTracks:function(e){return{type:"REPLACE_ALL_TRACKS",tracks:e}}})(ze),Fe=["user-top-read","user-modify-playback-state"],Ge=function(){var e=window.location.hash.substring(1).split("&").reduce(function(e,t){if(t){var n=t.split("=");e[n[0]]=decodeURIComponent(n[1])}return e},{});return window.location.hash="",e},Ue=function(){var e=localStorage.getItem("token"),t=localStorage.getItem("expirationTime"),n=new Date;if(e&&!(n.getTime()>t))return e},We=function(e,t){var n=(new Date).getTime()+1e3*parseInt(t);localStorage.setItem("token",e),localStorage.setItem("expirationTime",n)},Be=function(){var e=Ge(),t=e.access_token;t?We(t,e.expires_in):t=Ue();var n=new URLSearchParams(window.location.search).get("tracks"),a=n;return t||(window.location="".concat("https://accounts.spotify.com/authorize","?client_id=").concat("de8a7d941d164ea4854a21ebaca90c71","&redirect_uri=").concat("https://toftt.github.io/calendar/","&scope=").concat(Fe.join("%20"),"&response_type=token&show_dialog=true&state=").concat(a)),{token:t,hashState:e.state||n||"null"}},He=Object(h.b)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0;switch(console.log(t),t.type){case"SET_TOKEN":return Object(m.a)({},e,{token:t.token});case"SET_TRACK":return Object(m.a)({},e,{tracks:e.tracks.map(function(e,n){return n+1!==t.index?e:t.track})});case"REPLACE_ALL_TRACKS":return Object(m.a)({},e,{tracks:t.tracks});case"ADD_RECOMMENDATIONS":var n=t.tracks;return Object(m.a)({},e,{tracks:e.tracks.map(function(e){return e||n.shift()})});case"SET_SEARCH_RESULTS":return Object(m.a)({},e,{searchResults:t.tracks});case"SET_CATEGORIES":return Object(m.a)({},e,{categories:t.categories});case"REMOVE_TRACK":return Object(m.a)({},e,{tracks:e.tracks.map(function(e,n){return n+1===t.index?null:e})});case"PLAY":return Object(m.a)({},e,{currentlyPlaying:t.trackId});case"PAUSE":return Object(m.a)({},e,{currentlyPlaying:null});default:return e}}),Ye=Be(),Je=Ye.token,Ve=Ye.hashState;He.dispatch({type:"SET_TOKEN",token:Je});var qe=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return"null"!==Ve?r.a.createElement(d.a,{store:He},r.a.createElement(Ke,{trackIds:Ve.split("_")})):r.a.createElement(d.a,{store:He},r.a.createElement(Le,null))}}]),t}(a.Component);o.a.render(r.a.createElement(qe,null),document.getElementById("root"))}},[[112,2,1]]]);
//# sourceMappingURL=main.5f1131e9.chunk.js.map